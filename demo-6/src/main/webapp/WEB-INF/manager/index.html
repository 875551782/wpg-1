<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
	<script type="text/javascript" src="//cdn.staticfile.org/jquery/2.0.0/jquery.min.js"></script>
	<script type="text/javascript" src="//cdn.staticfile.org/jqueryui/1.10.2/jquery-ui.min.js"></script>
	<script type="text/javascript" src="//cdn.staticfile.org/jqueryui-touch-punch/0.2.2/jquery.ui.touch-punch.min.js"></script>
	<script type="text/javascript" src="//cdn.staticfile.org/twitter-bootstrap/3.0.1/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="v3/jquery.htmlClean.js"></script>
	<script type="text/javascript" src="v3/scripts.min.js"></script>
	<link rel="stylesheet" href="css/bootstrap.css">
	<script type="text/javascript" src="jquery-1.8.3/jquery.min.js"></script>
	<style>
	.addw,.edit{
		display:none;
		top: 0px;
		width: 100%;
		height: 100%;
		z-index: 10;
		display: none;
		background:white;
	}

</style>
</head>
<body>
	<div class="container">
	<div class="row clearfix">
		<div class="col-md-12 column">
			<div class="tabbable" id="tabs-362670">
				<ul class="nav nav-tabs">
					<li class="active">
						 <a href="#panel-1" data-toggle="tab" id="data" name="datas">数据采集</a>
					</li>
					<li>
						 <a href="#panel-1" data-toggle="tab" id="vedio" name="videos">视频系统</a>
					</li>
					<li>
						 <a href="#panel-1" data-toggle="tab" id="door" name="doors">门禁系统</a>
					</li>
					<li>
						 <a href="#panel-1" data-toggle="tab" id="talk" name="talks">对讲系统</a>
					</li>
					<li>
						 <a href="#panel-1" data-toggle="tab" id="safe" name="safes">安防系统</a>
					</li>
					<li>
						 <a href="#panel-1" data-toggle="tab" id="internet" name="internets">网络设备</a>
					</li>
					<li>
						 <a href="#panel-1" data-toggle="tab" id="energy" name="energys">能量分析</a>
					</li>
					<li>
						 <a href="#panel-1" data-toggle="tab" id="water" name="waters">水质监测</a>
					</li>
					<li>
						 <a href="#panel-1" data-toggle="tab" id="enviroment" name="environments">环境监测</a>
					</li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane active" id="panel-1">
						
					</div>

				</div>
			</div>
			
			<div id="addWare" class="addw">
				<form method="post" id="form" action="admin_addHardware_Group.do">
				  <div class="form-group">
				    <label for="exampleInputEmail1">物料名称</label>
				    <input type="text" class="form-control" id="exampleInputEmail1"  name="name">
				  </div>
				  <div class="form-group">
				    <label for="exampleInputPassword1">视规格型号</label>
				    <input type="text" class="form-control" id="exampleInputPassword1"  name="type">
				  </div>
				  <div class="form-group">
				    <label for="exampleInputFile">单位</label>
				    <input type="text" class="form-control" id="exampleInputFile" name="unit">
				  </div>
				 	<div class="form-group">
				    <label for="exampleInputPassword1">数量</label>
				    <input type="text" class="form-control" name="num">
				  </div>
				 	<div class="form-group">
				    <label for="exampleInputPassword1">品牌</label>
				    <input type="text" class="form-control"  name="brand">
				  </div>
				 <div class="form-group">
				    <label for="exampleInputPassword1">说明</label>
				    <input type="text" class="form-control"  name="desct">
				 </div>
				 <div class="form-group">
				    <label for="exampleInputPassword1" >标配</label>
				    <input type="text" class="form-control" placeholder="是/否" name="states">
				 </div>
				 <div class="form-group">
				    <label for="exampleInputPassword1">价格</label>
				    <input type="text" class="form-control"  name="price">
				 </div>
				 <div class="form-group">
				    <input type="hidden" class="form-control"  name="module" id="module">
				    <input type="hidden" class="form-control"  name="flag" id="flag">
				    <input type="hidden" class="form-control"  name="mark" id="mark">
				 </div>
			  	<button type="submit" class="btn btn-success" style="margin-left:180px;" id="submit">提交</button>
			</div>
			
			
			<div class="edit" id="edit">
				<div class="dapCon">
					<h3>修改物料</h3>
					<div class="input-group">
						<span class="input-group-addon">物料名称</span> <input type="text"
							class="form-control" aria-describedby="basic-addon1" name="name1">
					</div>
					<div class="input-group">
						<span class="input-group-addon">规格型号</span> <input type="text"
							class="form-control" aria-describedby="basic-addon1" name="type1">
					</div>
					<div class="input-group">
						<span class="input-group-addon">单位</span> <input type="text"
							class="form-control" aria-describedby="basic-addon1" name="unit1">
					</div>
					<div class="input-group">
						<span class="input-group-addon">数量</span> <input type="number"
							class="form-control" aria-describedby="basic-addon1" name="num1">
					</div>
					<div class="input-group">
						<span class="input-group-addon">品牌</span> <input type="text"
							class="form-control" aria-describedby="basic-addon1" name="brand1">
					</div>
					<div class="input-group">
						<span class="input-group-addon">价格</span> <input type="text"
							class="form-control" aria-describedby="basic-addon1" name="price1">
					</div>
					<div class="input-group">
						<span class="input-group-addon">是否标配</span><input type="text"
							class="form-control" aria-describedby="basic-addon1" value="否" name="states1">
					</div>
					<div class="input-group">
						<span class="input-group-addon">说明</span> <input type="text"
							class="form-control" aria-describedby="basic-addon1" name="desct1">
					</div>
					<input class="form-control" type="hidden" name="mark1">
					<input class="form-control" type="hidden" name="module1">
					<input class="form-control" type="hidden" name="id1">
					<div class="input-group">
						<button type="button" class="btn btn-primary btn-updata" id="save">保存</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	
</div>
</body>
</html>
<script>
$("a").click(function(){
	$("#addWare").css("display","none");
	$("#edit").css("display","none");
	$.ajax({
		url:"admin_viewHardwareAll.do",
		data:{"module":this.name},
		success:function(data){
			var str="";
			var flag=0;
			var flag1=0;
			var flag2=0;
			if(data.length>0){
				for(var i=0;i<data.length;i++){
					flag=1;
					flag1=1;
					flag2=1;
					for(var j=0;j<data[i].hardwareList.length;j++){
					/* 	alert(data[i+1].mark) */
						if(data[i].hardwareList[j].dFlag==1){
								str+="<tr><td>"+data[i].hardwareList[j].name+"</td><td>"+data[i].hardwareList[j].type+"</td><td>"+data[i].hardwareList[j].unit+"</td>"+
								"<td>"+data[i].hardwareList[j].num+"</td><td>"+data[i].hardwareList[j].brand+"</td>"
								if(data[i].hardwareList.length>=1&&flag1==1){
									if(data[i].states==1){
										str+="<td rowspan='"+data[i].hardwareList.length+"' style='vertical-align:middle;text-align:center;'>是";
										flag1=0;
									}else{
										str+="<td rowspan='"+data[i].hardwareList.length+"' style='vertical-align:middle;text-align:center;'>否";
										flag1=0;
									}
								}
								str+="</td><td>"+data[i].hardwareList[j].price+"</td>";
								if(data[i].hardwareList.length>=1&&flag2==1){
										str+="<td rowspan='"+data[i].hardwareList.length+"' style='vertical-align:middle;text-align:center;'>"+data[i].desct+"</td>";
										flag2=0;
								}
							str+="<td><button type='button' class='btn btn-warning' onclick=update('"+data[i].hardwareList[j].id+"','"+data[i].hardwareList[j].name+"','"+Trim(data[i].hardwareList[j].type)+"','"+data[i].hardwareList[j].unit+"','"+data[i].hardwareList[j].num+"','"+data[i].hardwareList[j].brand+"','"+data[i].hardwareList[j].price+"','"+data[i].hardwareList[j].desct+"','"+data[i].mark+"','"+data[i].hardwareList[j].module+"')>修改</button></td><td>"+
							"<button type='button' class='btn btn-danger' onclick=deldata('"+data[i].hardwareList[j].module+"',"+data[i].hardwareList[j].id+")>删除</button></td>";
							if(data[i].hardwareList.length>=1&&flag==1){
								str+="<td rowspan='"+data[i].hardwareList.length+"'  style='vertical-align:middle;text-align:center;'>"
									+"<input type='button' class='btn btn-primary' name='btn-add' onclick=fun('"+data[i].mark+"','"+data[0].hardwareList[0].module+"') value='添加'    onclick=fun('"+data[0].hardwareList[0].module+"')></td></tr>";
									flag=0;
							}
						}
					}
				}
			}
			$("#panel-1").html("<table class='table table-bordered' id='content'><tr><th>物料名称</th><th>规格型号</th><th>单位</th>"+
			"<th>数量</th><th>品牌</th><th>是否标配</th><th>价格</th><th>说明</th><th></th><th></th><th></th></tr>"+str+"</table><button type='button' class='btn btn-primary' id='add' name='"+data[0].hardwareList[0].module+"'>添加物料</button>");
		}
	})
	
})
function getdata(module){
	$.ajax({
		url:"admin_viewHardwareAll.do",
		data:{"module":module},
		success:function(data){
			var str="";
			var flag=0;
			var flag1=0;
			var flag2=0;
			if(data.length>0){
				for(var i=0;i<data.length;i++){
					flag=1;
					flag1=1;
					flag2=1;
					for(var j=0;j<data[i].hardwareList.length;j++){
					/* 	alert(data[i+1].mark) */
						if(data[i].hardwareList[j].dFlag==1){
								str+="<tr><td>"+data[i].hardwareList[j].name+"</td><td>"+data[i].hardwareList[j].type+"</td><td>"+data[i].hardwareList[j].unit+"</td>"+
								"<td>"+data[i].hardwareList[j].num+"</td><td>"+data[i].hardwareList[j].brand+"</td>"
								if(data[i].hardwareList.length>=1&&flag1==1){
									if(data[i].states==1){
										str+="<td rowspan='"+data[i].hardwareList.length+"' style='vertical-align:middle;text-align:center;'>是";
										flag1=0;
									}else{
										str+="<td rowspan='"+data[i].hardwareList.length+"' style='vertical-align:middle;text-align:center;'>否";
										flag1=0;
									}
								}
								str+="</td><td>"+data[i].hardwareList[j].price+"</td>";
								if(data[i].hardwareList.length>=1&&flag2==1){
										str+="<td rowspan='"+data[i].hardwareList.length+"' style='vertical-align:middle;text-align:center;'>"+data[i].desct+"</td>";
										flag2=0;
								}
							str+="<td><button type='button' class='btn btn-warning' onclick=update('"+data[i].hardwareList[j].id+"','"+data[i].hardwareList[j].name+"','"+data[i].hardwareList[j].unit+"','"+data[i].hardwareList[j].num+"','"+data[i].hardwareList[j].brand+"','"+data[i].hardwareList[j].price+"','"+data[i].hardwareList[j].desct+"','"+data[i].mark+"','"+data[i].hardwareList[j].module+"')>修改</button></td><td>"+
							"<button type='button' class='btn btn-danger' onclick=deldata('"+data[i].hardwareList[j].module+"',"+data[i].hardwareList[j].id+")>删除</button></td>";
							if(data[i].hardwareList.length>=1&&flag==1){
								str+="<td rowspan='"+data[i].hardwareList.length+"'  style='vertical-align:middle;text-align:center;'>"
									+"<input type='button' class='btn btn-warning' name='btn-add' onclick=fun('"+data[i].mark+"','"+data[0].hardwareList[0].module+"') value='添加'  onclick=fun('"+data[0].hardwareList[0].module+"')></td></tr>";
									flag=0;
							}
						}
					}
				}
			}
			$("#panel-1").html("<table class='table table-bordered' id='content'><tr><th>物料名称</th><th>规格型号</th><th>单位</th>"+
			"<th>数量</th><th>品牌</th><th>是否标配</th><th>价格</th><th>说明</th><th></th><th></th><th></th></tr>"+str+"</table><button type='button' class='btn btn-primary' id='add' name='"+data[0].hardwareList[0].module+"'>添加物料</button>");
		}
	})
}
function deldata(module,id){
	if(confirm("删除是不可恢复的，你确认要删除吗？")){
		$.ajax({
			type:"GET",
			url:"admin_delHardware.do",
			data:{module:module,id:id},
			success:function(data){
				getdata(data);
			}
		})
	}
};
$("#add").live("click",function(){
	$("#addWare").css("display","block");
	$("#content").css("display","none");
	$("#add").css("display","none");
	$("#module").attr("value",this.name);
	$("#flag").attr("value",1);
})
function fun(mark,module){
	$("#addWare").css("display","block");
	$("#content").css("display","none");
	$("#add").css("display","none");
	$("#module").attr("value",module);
	$("#mark").attr("value",mark);
	$("#flag").attr("value",0);
}
function update(id,name,type,unit,num,brand,price,desct,mark,module){
	$("#edit").css("display","block");
	$("#content").css("display","none");
	$("#add").css("display","none");
	$("input[name=name1]").val(name);
	$("input[name=unit1]").val(unit);
	$("input[name=num1]").val(num);
	$("input[name=type1]").val(type);
	$("input[name=brand1]").val(brand);
	$("input[name=price1]").val(price);
	$("input[name=desct1]").val(desct);
	$("input[name=mark1]").val(mark);
	$("input[name=module1]").val(module);
	$("input[name=id1]").val(id);
}
	$("#save").live("click",function(){
		var name1=$("input[name=name1]").val();
		var unit1=$("input[name=unit1]").val();
		var num1=$("input[name=num1]").val();
		var brand1=$("input[name=brand1]").val();
		var price1=$("input[name=price1]").val();
		var states1=$("input[name=states1]").val();
		var type1=$("input[name=type1]").val();
		var mark=$("input[name=mark1]").val();
		var module=$("input[name=module1]").val();
		var id=$("input[name=id1]").val();
		
		$.ajax({
			url:"admin_updateHardware.do",
			data:{
				"id":id,
				"name":name1,
				"type":type1,
				"unit":unit1,
				"num":num1,
				"brand":brand1,
				"price":price1,
				"states":states1,
				"mark":mark,
				"module":module
			},
			success:function(data){
				$("#edit").css("display","none");
				getdata(data);
			}
		})
	})
	function Trim(str)
	 { 
	  return str.replace(/(^\s*)|(\s*$)/g, ""); 
	}
</script>